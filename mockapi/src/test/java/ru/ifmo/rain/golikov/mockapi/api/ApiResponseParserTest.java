package ru.ifmo.rain.golikov.mockapi.api;

import org.assertj.core.api.Assertions;
import org.junit.Before;
import org.junit.Test;

import java.util.*;

import static org.assertj.core.api.Assertions.assertThat;
import static org.assertj.core.api.Assertions.failBecauseExceptionWasNotThrown;
import static ru.ifmo.rain.golikov.mockapi.TestUtils.makeInstants;

public class ApiResponseParserTest {
  private ApiResponseParser parser;

  @Before
  public void setUp() {
    parser = new ApiResponseParser();
  }

  final private static String REAL_RESPONSE = """
    {"response":{"items":[{"id":13663,"date":1634460244,"owner_id":-84793390,"from_id":816328,"post_id":13653,"parents_stack":[13656],"post_type":"reply","text":"Победители региональных этапов 2020-2021 будут участвовать в мировом финале в ноябре 2022 в Бангладеше (45th Annual ICPC World Finals). Но это не точно.\\n\\nА уже сейчас уже идут квалификации на 2021-2022...","marked_as_ads":0,"post_source":{"type":"vk"},"comments":{"can_post":0,"count":0},"likes":{"can_like":1,"count":0,"user_likes":0,"can_publish":1},"reposts":{"count":0,"user_reposted":0},"donut":{"is_donut":false},"short_text_rate":0.800000},{"id":13662,"date":1634454979,"owner_id":-84793390,"from_id":165230314,"post_id":13653,"parents_stack":[13656],"post_type":"reply","text":"Интересно, а как теперь быть тем, кто намеревался участвовать и готовился к ICPC 2021?","marked_as_ads":0,"post_source":{"type":"vk"},"comments":{"can_post":0,"count":0},"likes":{"can_like":1,"count":0,"user_likes":0,"can_publish":1},"reposts":{"count":0,"user_reposted":0},"donut":{"is_donut":false},"short_text_rate":0.800000},{"id":1090,"date":1634454004,"owner_id":-148268394,"from_id":-148268394,"post_type":"post","text":"Начались основные туры сегодняшних соревнований.\\n\\nСледить за результатами участников вы можете по ссылкам:\\n\\n- Квалификационный тур Уральского регионального чемпионата ICPC\\nhttps:\\/\\/timus.online\\/monitor.aspx?id=1248\\n\\n- Первый отбор на УрКОП для Свердловской области\\nhttps:\\/\\/timus.online\\/monitor.aspx?id=1267\\n\\n- Отбор на УрКОП для других регионов\\nhttps:\\/\\/timus.online\\/monitor.aspx?id=1268\\n\\n- Отбор для младшей лиги на УрКОП.Юниоры\\nhttps:\\/\\/timus.online\\/monitor.aspx?id=1269","marked_as_ads":0,"attachments":[{"type":"photo","photo":{"album_id":-7,"date":1634453972,"id":457239824,"owner_id":-148268394,"has_tags":false,"access_key":"315bd79f4e76131e71","post_id":1090,"sizes":[{"height":78,"url":"https:\\/\\/sun9-18.userapi.com\\/impg\\/8mkomslc1pfYK3ru2nFWBSAamLfWgDR6JPHeiw\\/PghKTdkDbGw.jpg?size=130x78&quality=96&sign=fc43956e880e8f6b66b5555efe5b2b99&c_uniq_tag=RHbyosoFJ2afGWIQ84Wkbx-tXGxR7U_4pLn7YCUl9fQ&type=album","type":"m","width":130},{"height":87,"url":"https:\\/\\/sun9-18.userapi.com\\/impg\\/8mkomslc1pfYK3ru2nFWBSAamLfWgDR6JPHeiw\\/PghKTdkDbGw.jpg?size=130x87&quality=96&crop=125,0,2310,1546&sign=770817520f8227197ae2a403508a8eb3&c_uniq_tag=rbEeOYyX7q6F1tZQNBVV7WXtKpzbs39_HZvSG9vK_8M&type=album","type":"o","width":130},{"height":133,"url":"https:\\/\\/sun9-18.userapi.com\\/impg\\/8mkomslc1pfYK3ru2nFWBSAamLfWgDR6JPHeiw\\/PghKTdkDbGw.jpg?size=200x133&quality=96&crop=117,0,2325,1546&sign=24d02f70a2660de3b83cbc1d2c40caef&c_uniq_tag=zQOr-CtsrVqvj43jt1KosOr7Wzh8Btdv4T5Ug9WNzL0&type=album","type":"p","width":200},{"height":213,"url":"https:\\/\\/sun9-18.userapi.com\\/impg\\/8mkomslc1pfYK3ru2nFWBSAamLfWgDR6JPHeiw\\/PghKTdkDbGw.jpg?size=320x213&quality=96&crop=118,0,2323,1546&sign=2560013d48af2afcbd248fdd9d7dad31&c_uniq_tag=1C44P4deNEQl4BDHuu2hYoEwWcH6egQhIyXsomcAQ70&type=album","type":"q","width":320},{"height":340,"url":"https:\\/\\/sun9-18.userapi.com\\/impg\\/8mkomslc1pfYK3ru2nFWBSAamLfWgDR6JPHeiw\\/PghKTdkDbGw.jpg?size=510x340&quality=96&crop=120,0,2319,1546&sign=e4fda394dc3b3dcc83ebe088b7e23bd1&c_uniq_tag=4qLDHSqL3cZrQeGa_dO25CO-8p6qa3BGddw0XM7psEI&type=album","type":"r","width":510},{"height":45,"url":"https:\\/\\/sun9-18.userapi.com\\/impg\\/8mkomslc1pfYK3ru2nFWBSAamLfWgDR6JPHeiw\\/PghKTdkDbGw.jpg?size=75x45&quality=96&sign=43c369d75eeddbfab41730a121a92aaf&c_uniq_tag=DJM28hPDd9OHRTR5_XaD2Qe6uRVRaqo8q925_1OcINo&type=album","type":"s","width":75},{"height":1546,"url":"https:\\/\\/sun9-18.userapi.com\\/impg\\/8mkomslc1pfYK3ru2nFWBSAamLfWgDR6JPHeiw\\/PghKTdkDbGw.jpg?size=2560x1546&quality=96&sign=87fe0c8358c5cc2e4b8a318a7ce0a122&c_uniq_tag=fydXVZlZGHNckuLVqkdpDKmNdbayDF_1B-6OicVaCE8&type=album","type":"w","width":2560},{"height":364,"url":"https:\\/\\/sun9-18.userapi.com\\/impg\\/8mkomslc1pfYK3ru2nFWBSAamLfWgDR6JPHeiw\\/PghKTdkDbGw.jpg?size=604x365&quality=96&sign=899af2ff92e97f6793117c341a532a9f&c_uniq_tag=k7RGqWrUqQBt4tUxFuvnXNjl98Lvpnk5GPsgkWymsqw&type=album","type":"x","width":604},{"height":487,"url":"https:\\/\\/sun9-18.userapi.com\\/impg\\/8mkomslc1pfYK3ru2nFWBSAamLfWgDR6JPHeiw\\/PghKTdkDbGw.jpg?size=807x487&quality=96&sign=98fbde3af1f98145ff76c91bf24d8f3f&c_uniq_tag=wvMOODkSFB1BgHs7IMRTdjsX5qrKqOoMF0rZlalD8jA&type=album","type":"y","width":807},{"height":773,"url":"https:\\/\\/sun9-18.userapi.com\\/impg\\/8mkomslc1pfYK3ru2nFWBSAamLfWgDR6JPHeiw\\/PghKTdkDbGw.jpg?size=1280x773&quality=96&sign=29dc131c7613575a48af0dfd4ef2df97&c_uniq_tag=TWao7GuTGh5f9v8RZ23Ww1R-BpPCwYCwQ25jY1L1FRs&type=album","type":"z","width":1280}],"text":"","user_id":100}}],"post_source":{"type":"vk"},"comments":{"can_post":1,"count":0,"groups_can_post":true},"likes":{"can_like":1,"count":5,"user_likes":0,"can_publish":1},"reposts":{"count":1,"user_reposted":0},"views":{"count":253},"donut":{"is_donut":false},"short_text_rate":0.800000},{"id":29996,"date":1634426133,"owner_id":797307,"from_id":797307,"post_type":"post","text":"заставка так вообще катапульта 10005G в аудиовизуальную нирвану","attachments":[{"type":"video","video":{"access_key":"5760c36b159404975e","can_comment":0,"can_like":1,"can_repost":1,"can_subscribe":1,"can_add_to_faves":1,"can_add":1,"comments":0,"date":1633268983,"description":"We are glad to show you the great opening ceremony of ICPC World Finals Moscow from Zaryadye Hall\\n\\nJoin us to live broadcast! \\n#icpcwfmoscow","duration":9707,"image":[{"height":96,"url":"https:\\/\\/sun9-43.userapi.com\\/impf\\/68JdUXsw7g-LaBi2GOAt02sz5WzJWOw0lfAJAA\\/33aQkGWmv0g.jpg?size=130x96&quality=96&keep_aspect_ratio=1&background=000000&sign=8b17c830e35ed1e5cfd5d3660003e811&c_uniq_tag=8LpEkLwjc1k0ut44v0wx96kirV1pLI_ATQ0sfcly6-8&type=video_thumb","width":130,"with_padding":1},{"height":120,"url":"https:\\/\\/sun9-43.userapi.com\\/impf\\/68JdUXsw7g-LaBi2GOAt02sz5WzJWOw0lfAJAA\\/33aQkGWmv0g.jpg?size=160x120&quality=96&keep_aspect_ratio=1&background=000000&sign=d637cc8512fb10021d0761210cd26085&c_uniq_tag=5AlXpaW5Vfv2cZlw84RqOGWY8zWxrnuRBBpgEctA0DI&type=video_thumb","width":160,"with_padding":1},{"height":240,"url":"https:\\/\\/sun9-43.userapi.com\\/impf\\/68JdUXsw7g-LaBi2GOAt02sz5WzJWOw0lfAJAA\\/33aQkGWmv0g.jpg?size=320x240&quality=96&keep_aspect_ratio=1&background=000000&sign=b044bf6a2f3769fb5a97f43ab359f2ec&c_uniq_tag=LYgiUUFzcUP5CPFfxBos1fRMlcMbtBMpW-FH0-4_Tbs&type=video_thumb","width":320,"with_padding":1},{"height":450,"url":"https:\\/\\/sun9-43.userapi.com\\/impf\\/68JdUXsw7g-LaBi2GOAt02sz5WzJWOw0lfAJAA\\/33aQkGWmv0g.jpg?size=800x450&quality=96&keep_aspect_ratio=1&background=000000&sign=8fbd41248b98870973bfbaee5ef9f781&c_uniq_tag=LgxKk6bqcWLcUOTRwA1zN_wgP1mjfT2QQUf0DWesHws&type=video_thumb","width":800,"with_padding":1},{"height":690,"url":"https:\\/\\/sun9-43.userapi.com\\/impf\\/68JdUXsw7g-LaBi2GOAt02sz5WzJWOw0lfAJAA\\/33aQkGWmv0g.jpg?size=1280x690&quality=96&sign=4b315c679d56aa4e4a173a6e9272ef8a&c_uniq_tag=CrWBXL8Lq9YIsZ4XKBbyuruHDwJROp_RDUgqrqb7XEY&type=video_thumb","width":1280},{"height":172,"url":"https:\\/\\/sun9-43.userapi.com\\/impf\\/68JdUXsw7g-LaBi2GOAt02sz5WzJWOw0lfAJAA\\/33aQkGWmv0g.jpg?size=320x172&quality=96&sign=db82ba65810644cced06f734d90e95f5&c_uniq_tag=dxICBy7u5Yx8G1HvcB7JxDrs_7qEawHeV5t2hapMvZY&type=video_thumb","width":320},{"height":388,"url":"https:\\/\\/sun9-43.userapi.com\\/impf\\/68JdUXsw7g-LaBi2GOAt02sz5WzJWOw0lfAJAA\\/33aQkGWmv0g.jpg?size=720x388&quality=96&sign=2f8cad506ef07481f1be74db7e2b5ca2&c_uniq_tag=mYtY6Y-mPESaduEApeXeAXa9OIwr5QFKik7Ag8q81Ws&type=video_thumb","width":720},{"height":552,"url":"https:\\/\\/sun9-43.userapi.com\\/impf\\/68JdUXsw7g-LaBi2GOAt02sz5WzJWOw0lfAJAA\\/33aQkGWmv0g.jpg?size=1024x552&quality=96&sign=0e561ed8b086cfa28ab74975968ac696&c_uniq_tag=wCG9kC3uQzpTDzQ_GkJdLpUaftzdweihsuUGcOel1o4&type=video_thumb","width":1024},{"height":2207,"url":"https:\\/\\/sun9-43.userapi.com\\/impf\\/68JdUXsw7g-LaBi2GOAt02sz5WzJWOw0lfAJAA\\/33aQkGWmv0g.jpg?size=0x0&quality=90&proxy=1&sign=fc845e5a08ba4e75051001de1e733fcb&c_uniq_tag=C7PCMhIAgsI3R6o4NPSjQXF_su7kRV-oQ0fzHXnjsdc&type=video_thumb","width":4096}],"first_frame":[{"height":172,"url":"https:\\/\\/sun9-20.userapi.com\\/impf\\/mubk-mvhqgsrFwVbo05QMgWYyWkGo_F9-iJXEw\\/1u1Dtey-ooo.jpg?size=320x172&quality=96&sign=c82f9477952bba97bbb11f0ce0ea102e&c_uniq_tag=YZvnCbE-1PHbdwaPtI3kwJZw8ViftxD3FIQqEk2DwY4&type=video_first_frame","width":320},{"height":86,"url":"https:\\/\\/sun9-20.userapi.com\\/impf\\/mubk-mvhqgsrFwVbo05QMgWYyWkGo_F9-iJXEw\\/1u1Dtey-ooo.jpg?size=160x86&quality=96&sign=31ddaeac4686b4a8b708f9dfeba329ad&c_uniq_tag=Y71_f1EfnamjyRkzsHe3FURMgsh2SZVdtihZosEfe_I&type=video_first_frame","width":160},{"height":2207,"url":"https:\\/\\/sun9-20.userapi.com\\/impf\\/mubk-mvhqgsrFwVbo05QMgWYyWkGo_F9-iJXEw\\/1u1Dtey-ooo.jpg?size=0x0&quality=90&proxy=1&sign=91a8a6e39fbbc6d8b3cdef4ccc9c0a1f&c_uniq_tag=S-7CBGXD9ADAJPu-gr-kOQMwZef9d8jllDBLPzp3_yU&type=video_first_frame","width":4096},{"height":70,"url":"https:\\/\\/sun9-20.userapi.com\\/impf\\/mubk-mvhqgsrFwVbo05QMgWYyWkGo_F9-iJXEw\\/1u1Dtey-ooo.jpg?size=130x70&quality=96&sign=62244c468c2083fa0bb5a12ee5cd0cf9&c_uniq_tag=1aeNzeh6MPgCHOK5vo1srTj9DT_LdI_Pnw_RLzN21Uk&type=video_first_frame","width":130},{"height":172,"url":"https:\\/\\/sun9-20.userapi.com\\/impf\\/mubk-mvhqgsrFwVbo05QMgWYyWkGo_F9-iJXEw\\/1u1Dtey-ooo.jpg?size=320x172&quality=96&sign=c82f9477952bba97bbb11f0ce0ea102e&c_uniq_tag=YZvnCbE-1PHbdwaPtI3kwJZw8ViftxD3FIQqEk2DwY4&type=video_first_frame","width":320},{"height":388,"url":"https:\\/\\/sun9-20.userapi.com\\/impf\\/mubk-mvhqgsrFwVbo05QMgWYyWkGo_F9-iJXEw\\/1u1Dtey-ooo.jpg?size=720x388&quality=96&sign=35d4f2d3b5e2cbb1b65c18475dfb2ce7&c_uniq_tag=bniYKKtTRnXaOqulDu0OQUUrgO2K1ZAYLxt2icY9_IU&type=video_first_frame","width":720},{"height":552,"url":"https:\\/\\/sun9-20.userapi.com\\/impf\\/mubk-mvhqgsrFwVbo05QMgWYyWkGo_F9-iJXEw\\/1u1Dtey-ooo.jpg?size=1024x552&quality=96&sign=c8902895f4fba657b2275f535368100e&c_uniq_tag=bEN-_ULlAeXxcnI9Tn7WyjQR5TAacD9yZRpqOzuR1Lw&type=video_first_frame","width":1024},{"height":690,"url":"https:\\/\\/sun9-20.userapi.com\\/impf\\/mubk-mvhqgsrFwVbo05QMgWYyWkGo_F9-iJXEw\\/1u1Dtey-ooo.jpg?size=1280x690&quality=96&sign=16f7c38192702ee824cd0a26c7718138&c_uniq_tag=9dgJr4J7in4O1y6rxLfsDxIrncQw4_q8OPbc7jKarXI&type=video_first_frame","width":1280},{"height":431,"url":"https:\\/\\/sun9-20.userapi.com\\/impf\\/mubk-mvhqgsrFwVbo05QMgWYyWkGo_F9-iJXEw\\/1u1Dtey-ooo.jpg?size=800x431&quality=96&sign=4cc160d9d63aaa73ad6a114dcd44a5f3&c_uniq_tag=LLpd5q06UfIDpGr-ul6qxPNUZeS0UudUJztDnjCzsYI&type=video_first_frame","width":800}],"width":1920,"height":1080,"id":456239382,"owner_id":-63042205,"ov_id":"3082949372886","title":"ICPC World Finals Moscow Opening Ceremony","track_code":"video_a4264a129Qjbc5l2tG1ftoCoiZfcGpx_z8lO2jtsdXvsoDQM203OLMV1nRmyZlS_g_e9ouoor0b88XzdTgIe","type":"video","views":1958}}],"post_source":{"type":"vk"},"comments":{"can_post":0,"count":0,"groups_can_post":true},"likes":{"can_like":1,"count":0,"user_likes":0,"can_publish":1},"reposts":{"count":0,"user_reposted":0},"views":{"count":6},"donut":{"is_donut":false},"short_text_rate":0.800000},{"id":29995,"date":1634424406,"owner_id":797307,"from_id":797307,"post_type":"post","text":"","attachments":[{"type":"photo","photo":{"album_id":-7,"date":1634424379,"id":457244452,"owner_id":797307,"has_tags":false,"access_key":"fcfbea6b3e57383240","sizes":[{"height":73,"url":"https:\\/\\/sun9-66.userapi.com\\/impg\\/lPtV1sFqvDpL7YZVHbBqcjlfqapraJKOX6gKog\\/_bUaTuk8j0w.jpg?size=130x73&quality=96&sign=bedbef40c6a358cc369c4fc86cae35cd&c_uniq_tag=lzwwS9nxI1u4nU2uZTl4u9Q90cLLroOUo4aq9z-l3tM&type=album","type":"m","width":130},{"height":87,"url":"https:\\/\\/sun9-66.userapi.com\\/impg\\/lPtV1sFqvDpL7YZVHbBqcjlfqapraJKOX6gKog\\/_bUaTuk8j0w.jpg?size=130x87&quality=96&crop=71,0,749,501&sign=bd72f0b0d8d782f86072246595359c37&c_uniq_tag=pHAugOWs0A6wSZm0bnUNlksqK1xqwfbDTQHgNPRmRqs&type=album","type":"o","width":130},{"height":133,"url":"https:\\/\\/sun9-66.userapi.com\\/impg\\/lPtV1sFqvDpL7YZVHbBqcjlfqapraJKOX6gKog\\/_bUaTuk8j0w.jpg?size=200x133&quality=96&crop=69,0,753,501&sign=caa0dd1828163700ad1bbe7baad8e0d8&c_uniq_tag=NQ6R8haOT5YLhP_UDlV2boNzKiIl07r9RZyfOEQxolA&type=album","type":"p","width":200},{"height":213,"url":"https:\\/\\/sun9-66.userapi.com\\/impg\\/lPtV1sFqvDpL7YZVHbBqcjlfqapraJKOX6gKog\\/_bUaTuk8j0w.jpg?size=320x213&quality=96&crop=69,0,753,501&sign=d4650b957d42346aaa9f4e620822fc42&c_uniq_tag=gfR32SkpSn5jlCuXj29-UqUlxk7sa989Mvc5wJDbJsg&type=album","type":"q","width":320},{"height":340,"url":"https:\\/\\/sun9-66.userapi.com\\/impg\\/lPtV1sFqvDpL7YZVHbBqcjlfqapraJKOX6gKog\\/_bUaTuk8j0w.jpg?size=510x340&quality=96&crop=70,0,751,501&sign=c15f51d4e687f3a950ce1e4a40b3f45c&c_uniq_tag=L4oCWLnBtOVevJmFtDYpQCnbAukDDT4uBUBS6iNGyVY&type=album","type":"r","width":510},{"height":42,"url":"https:\\/\\/sun9-66.userapi.com\\/impg\\/lPtV1sFqvDpL7YZVHbBqcjlfqapraJKOX6gKog\\/_bUaTuk8j0w.jpg?size=75x42&quality=96&sign=1303e59dc8cc2b4d98f95ccbaae79390&c_uniq_tag=skwnv94acJviwHIAU8YBThZzMAeTiFBHYclH69QPfMs&type=album","type":"s","width":75},{"height":339,"url":"https:\\/\\/sun9-66.userapi.com\\/impg\\/lPtV1sFqvDpL7YZVHbBqcjlfqapraJKOX6gKog\\/_bUaTuk8j0w.jpg?size=604x339&quality=96&sign=fd2f057106fe24f6971d2ab940291f62&c_uniq_tag=XX9gBxRFYmN9wHHCvEwRw146Q23_xD6lVG8BVANaMks&type=album","type":"x","width":604},{"height":453,"url":"https:\\/\\/sun9-66.userapi.com\\/impg\\/lPtV1sFqvDpL7YZVHbBqcjlfqapraJKOX6gKog\\/_bUaTuk8j0w.jpg?size=807x453&quality=96&sign=5cd41458445e1400046421316bf311ac&c_uniq_tag=LfJplHidOB0sXYhZTPk-fK0e24WNkKPDL9MACZ_utlc&type=album","type":"y","width":807},{"height":501,"url":"https:\\/\\/sun9-66.userapi.com\\/impg\\/lPtV1sFqvDpL7YZVHbBqcjlfqapraJKOX6gKog\\/_bUaTuk8j0w.jpg?size=892x501&quality=96&sign=ab02e639e66751d4ff749a36c76bbb23&c_uniq_tag=gMQbY3l1WOZRTohnOrLAj_03_tJtqS-cl9a7-TVJ7DU&type=album","type":"z","width":892}],"text":""}},{"type":"audio","audio":{"artist":"icpc","id":456244756,"owner_id":2000085858,"title":"feel the energy flow","duration":25,"is_explicit":false,"is_focus_track":false,"track_code":"95ddc20eH5Edzg_rtt9pCDOOlCXpq5xrsV5bRmeq3tbPue2YDK0Rmny6e4o","url":"https:\\/\\/vk.com\\/mp3\\/audio_api_unavailable.mp3","date":1634426821,"genre_id":18,"short_videos_allowed":false,"stories_allowed":false,"stories_cover_allowed":false}}],"post_source":{"type":"vk"},"comments":{"can_post":0,"count":0,"groups_can_post":true},"likes":{"can_like":1,"count":0,"user_likes":0,"can_publish":1},"reposts":{"count":0,"user_reposted":0},"views":{"count":4},"donut":{"is_donut":false},"short_text_rate":0.800000,"carousel_offset":0}],"next_from":"5\\/797307_29995","count":1000,"total_count":12320}}
  """;

  final private static String EMPTY_RESPONSE = """
    {"response":{"items":[]}}         
  """;

  final private static String SIMPLE_RESPONSE = """
    {"response":
      {"items":
        [
          {"date": 1},
          {"date": 22},
          {"date": 222}
        ]
      }
    }        
  """;

  final private static String ERROR_RESPONSE = """
    {"error":{"error_code":5,"error_msg":"User authorization failed: no access_token passed.","request_params":[{"key":"q","value":"icpc"},{"key":"v","value":"5.131"},{"key":"count","value":"5"},{"key":"method","value":"newsfeed.search"},{"key":"oauth","value":"1"}]}}        
  """;

  @Test
  public void parseResponse() {
    assertThat(parser.parseResponse(REAL_RESPONSE))
            .isEqualTo(makeInstants(
                    List.of(1634460244L, 1634454979L, 1634454004L, 1634426133L, 1634424406L)));
  }

  @Test
  public void parseEmptyResponse() {
    assertThat(parser.parseResponse(EMPTY_RESPONSE)).isEqualTo(List.of());
  }

  @Test
  public void parseSimpleResponse() {
    assertThat(parser.parseResponse(SIMPLE_RESPONSE))
            .isEqualTo(makeInstants(
                    List.of(1L, 22L, 222L)
            ));
  }

  @Test
  public void parseErrorResponse() {
    try {
      parser.parseResponse(ERROR_RESPONSE);
      Assertions.fail("Expected exception");
    } catch (final Exception e) {
      //  ok
    }
  }
}
